<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>计算题生成器</title>
  <style>
    /* 样式可以在这里添加 */
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
  </style>
</head>
<body>
  <h1>计算题生成器</h1>
  <label for="minRange">最小范围：</label>
  <input type="number" id="minRange" value="1">
  <br>
  <label for="maxRange">最大范围：</label>
  <input type="number" id="maxRange" value="10">
  <br>
  <label for="numOfValues">数值数量：</label>
  <input type="number" id="numOfValues" value="2">
  <br>
  <label for="numOfQuestions">每次出题数量：</label>
  <input type="number" id="numOfQuestions" value="5">
  <br>
  <input type="checkbox" id="addition" name="ysf" onclick="checkysf()">
  <label for="addition">加法</label>
  <input type="checkbox" id="subtraction" name="ysf" onclick="checkysf()">
  <label for="subtraction">减法</label>
  <input type="checkbox" id="multiplication" name="ysf" onclick="checkysf()">
  <label for="multiplication">乘法</label>
  <input type="checkbox" id="division" name="ysf" onclick="checkysf()">
  <label for="division">除法</label>
  <br>
  <button id="creat" disabled onclick="generateQuestions()">生成题目</button>
  <div id="questions"></div>
  <button id = "answerbutton" disabled onclick="checkAnswers()">提交答案</button>

  <script>
    function generateQuestions() {
      // 获取输入的值
      var minRange = parseInt(document.getElementById('minRange').value);
      var maxRange = parseInt(document.getElementById('maxRange').value);
      var numOfValues = parseInt(document.getElementById('numOfValues').value);
      var numOfQuestions = parseInt(document.getElementById('numOfQuestions').value);
      var includeAddition = document.getElementById('addition').checked;
      var includeSubtraction = document.getElementById('subtraction').checked;
      var includeMultiplication = document.getElementById('multiplication').checked;
      var includeDivision = document.getElementById('division').checked;

      var questionsDiv = document.getElementById('questions');
      questionsDiv.innerHTML = ''; // 清空之前的题目

      // 生成题目
      for (var i = 0; i < numOfQuestions; i++) {
        var question = generateQuestion(minRange, maxRange, numOfValues, includeAddition, includeSubtraction, includeMultiplication, includeDivision);
        var questionParagraph = document.createElement('p');
        questionParagraph.textContent = question;

        // 创建输入框
        var answerInput = document.createElement('input');
        answerInput.type = 'number';
        answerInput.placeholder = '输入答案';
        questionParagraph.appendChild(document.createTextNode(' = '));
        questionParagraph.appendChild(answerInput);
        answerInput.style.width = '80px';

        questionsDiv.appendChild(questionParagraph);
      }
      answerbutton.disabled = false;
    }

    function checkAnswers() {
      var inputs = document.querySelectorAll('#questions input[type="number"]');
      var allAnswered = true;

      // 检查是否所有的答案都已填写
      inputs.forEach(function(input) {
        if (!input.value) {
          allAnswered = false;
          return;
        }
      });

      // 提示用户有未填写的答案
      if (!allAnswered) {
        var confirmSubmit = confirm('有未填写的答案，确定要提交吗？');
        if (!confirmSubmit) {
          return;
        }
      }

      var submitButton = document.querySelector('button[onclick="checkAnswers()"]');
      submitButton.disabled = true;

      

    inputs.forEach(function(input) {
        var userAnswer = input.value.trim(); // 获取用户输入的答案
        var question = input.parentElement.textContent.split('=')[0].trim();
        var correctAnswer = calculateAnswer(question);
        var answerDisplay = document.createElement('span');


  // 检查用户答案是否为整数或浮点数，最多保留两位小数
  if (!isNaN(userAnswer) && userAnswer !== '') {
    userAnswer = parseFloat(userAnswer); // 将用户答案转换为浮点数
    userAnswer = userAnswer.toFixed(3); // 保留两位小数
    userAnswer = userAnswer % 1 === 0 ? parseInt(userAnswer) : parseFloat(userAnswer); // 转换为整数或浮点数
    
  }
    correctAnswer = parseFloat(correctAnswer); // 将用户答案转换为浮点数
    correctAnswer = correctAnswer.toFixed(3); // 保留两位小数
    correctAnswer = correctAnswer % 1 === 0 ? parseInt(correctAnswer) : parseFloat(correctAnswer); // 转换为整数或浮点数
    answerDisplay.textContent = ' (答案: ' + correctAnswer + ')';
  if (userAnswer === correctAnswer) {
    answerDisplay.classList.add('correct');
    answerDisplay.textContent += ' - 正确✅';
  } else {
    answerDisplay.classList.add('incorrect');
    answerDisplay.textContent += ' - 错误❎';
  }

  input.parentElement.appendChild(answerDisplay);
  
});
    
    }

    function generateQuestion(min, max, values, add, sub, mult, div) {
      var operators = [];
      if (add) operators.push('+');
      if (sub) operators.push('-');
      if (mult) operators.push('*');
      if (div) operators.push('/');

      var question = '';
      for (var i = 0; i < values; i++) {
        if (i > 0) {
          var operator = operators[Math.floor(Math.random() * operators.length)];
          question += ' ' + operator + ' ';
        }
        question += Math.floor(Math.random() * (max - min + 1) + min);
      }
      return question;
    }

    function calculateAnswer(question) {
      return eval(question);
    }

    function checkysf(){
        var checkBoxes = document.getElementsByName("ysf");
        var button = document.getElementById("creat");
        var checkedCount = 0;
        for (var i = 0; i < checkBoxes.length; i++) {
            if (checkBoxes[i].checked == true) {
                checkedCount++;
            }
        }
        if (checkedCount == 0) {
            button.disabled = true;
        } else {
            button.disabled = false;
            }
    }


  </script>
</body>
</html>
